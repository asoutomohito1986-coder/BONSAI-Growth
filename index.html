<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BONSAI PIXEL GROWTH</title>
    <style>
        /* Êöó„ÇÅ„ÅÆ„Éî„ÇØ„Çª„É´„Ç¢„Éº„ÉàÈ¢®„Éá„Ç∂„Ç§„É≥ */
        body { text-align: center; background: #121212; color: #ffffff; font-family: sans-serif; margin: 0; padding: 0; }
        #screen-init { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #0052FF; }
        #screen-game { display: none; padding: 20px; min-height: 100vh; }
        
        /* ÁõÜÊ†ΩË°®Á§∫„Ç®„É™„Ç¢ */
        .bonsai-container { 
            width: 300px; height: 300px; background: #222; margin: 20px auto; 
            border-radius: 15px; display: flex; align-items: center; justify-content: center;
            overflow: hidden; border: 4px solid #333; position: relative;
            image-rendering: pixelated; /* „Éâ„ÉÉ„Éà„Çí„Åè„Å£„Åç„Çä„Åï„Åõ„Çã */
        }
        .bonsai-container img { width: 100%; height: 100%; object-fit: cover; }
        
        /* „Çπ„ÉÜ„Éº„Çø„ÇπË°®Á§∫ */
        .stats-row { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .stat-box { background: #333; padding: 10px 20px; border-radius: 10px; border: 1px solid #444; }
        .stat-val { font-size: 24px; color: #4caf50; font-weight: bold; }

        /* „Éú„Çø„É≥ */
        .btn { padding: 18px 30px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; font-size: 18px; margin: 10px; width: 85%; }
        .btn-connect { background: #ffffff; color: #0052FF; width: 220px; }
        .btn-water { background: #4caf50; color: #fff; box-shadow: 0 4px 0 #2e7d32; }
        .btn-grow { background: #ff9800; color: #fff; box-shadow: 0 4px 0 #e68a00; }
        .btn:disabled { opacity: 0.3; transform: translateY(4px); box-shadow: none; }

        /* „Çø„Ç§„Éû„Éº„Å®„É°„ÉÉ„Çª„Éº„Ç∏ */
        #timer-text { color: #ffeb3b; font-size: 18px; font-weight: bold; height: 1.5em; margin-top: 10px; }
        #status-msg { font-size: 14px; color: #bbb; margin-top: 5px; }
        #death-info { color: #ff5252; font-size: 12px; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="screen-init">
        <div style="font-size: 80px;">üå≤</div>
        <h1 style="letter-spacing: 2px;">BONSAI GROWTH</h1>
        <button onclick="connect()" class="btn btn-connect">START SYSTEM</button>
    </div>

    <div id="screen-game">
        <div class="stats-row">
            <div class="stat-box">GP<br><span id="ui-gp" class="stat-val">0</span></div>
            <div class="stat-box">AGE<br><span id="ui-age" class="stat-val">0</span></div>
        </div>

        <div class="bonsai-container" id="ui-view">üå±</div>
        <div id="timer-text"></div>

        <button class="btn btn-water" onclick="onWater()">üíß Ê∞¥„ÇÑ„Çä (+10GP)</button>
        <button id="btn-grow" class="btn btn-orange btn-grow" onclick="onGrow()" disabled>‚ú® ÊàêÈï∑ (50GP)</button>
        
        <div id="status-msg"></div>
        <div id="death-info"></div>

        <button onclick="resetData()" style="margin-top: 60px; opacity: 0.2; color: white; background: none; border: none;">[Format Data]</button>
    </div>

    <script>
        let wallet = "";
        let gp = 0;
        let age = 0;
        let imgUrl = "";
        let lastWater = Date.now();
        const DEAD_TIME = 14 * 24 * 60 * 60 * 1000; // 14Êó•Èñì

        async function connect() {
            if (window.ethereum) {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    wallet = accounts[0];
                    load();
                    document.getElementById('screen-init').style.display = 'none';
                    document.getElementById('screen-game').style.display = 'block';
                    update();
                } catch (e) { alert("Êé•Á∂ö„Ç®„É©„Éº"); }
            } else {
                alert("Coinbase Wallet„Ç¢„Éó„É™„ÅßÈñã„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ");
            }
        }

        function onWater() {
            gp += 10;
            lastWater = Date.now();
            document.getElementById('status-msg').innerText = "Watering Successful!";
            save();
            update();
        }

        async function onGrow() {
            if (gp < 50) return;
            gp -= 50;
            age += 5;
            
            const view = document.getElementById('ui-view');
            const btn = document.getElementById('btn-grow');
            const timer = document.getElementById('timer-text');
            
            view.style.opacity = "0.4";
            btn.disabled = true;
            
            // „Ç´„Ç¶„É≥„Éà„ÉÄ„Ç¶„É≥ (10Áßí)
            let sec = 10;
            const interval = setInterval(() => {
                timer.innerText = "Generating... " + sec + "s";
                sec--;
                if (sec < 0) clearInterval(interval);
            }, 1000);

            // AIÁîªÂÉèÁîüÊàê„Éó„É≠„É≥„Éó„Éà (HD„Éî„ÇØ„Çª„É´„Ç¢„Éº„ÉàÁõÜÊ†Ω)
            const seed = Math.floor(Math.random() * 10000);
            const prompt = encodeURIComponent("single bonsai tree, pixel art style, 16-bit, centered, white background, high quality
